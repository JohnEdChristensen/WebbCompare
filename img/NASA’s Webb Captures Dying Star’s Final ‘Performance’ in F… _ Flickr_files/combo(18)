YUI.add("person-relationship-models",(function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},update:function(t,i){var r=[],n={};return e.Lang.isObject(i,!0)&&(n.user_id=t,n.friend=this.getValue(t,"isFriend"),n.family=this.getValue(t,"isFamily"),"isContact"in i&&(i.isContact.newVal?r.push(e.ModelUpdaters["flickr-contacts-add"].run(n,this.appContext)):r.push(e.ModelUpdaters["flickr-contacts-remove"].run(n,this.appContext))),("isFriend"in i||"isFamily"in i)&&("isFriend"in i&&(n.friend=i.isFriend.newVal),"isFamily"in i&&(n.family=i.isFamily.newVal),r.push(e.ModelUpdaters["flickr-contacts-edit"].run(n,this.appContext))),"isIgnored"in i&&(!0===i.isIgnored.newVal?r.push(e.ModelUpdaters["flickr-contacts-block"].run(n,this.appContext)):r.push(e.ModelUpdaters["flickr-contacts-unblock"].run(n,this.appContext)))),e.Promise.all(r)}},toggleFollowing:function(e){this.getValue(e,"isContact")?this.setValue(e,"isContact",!1):this.setValue(e,"isContact",!0)},toggleFriend:function(e){this.getValue(e,"isFriend")?this.setValue(e,"isFriend",!1):this.setValue(e,"isFriend",!0)},toggleFamily:function(e){this.getValue(e,"isFamily")?this.setValue(e,"isFamily",!1):this.setValue(e,"isFamily",!0)},toggleIgnore:function(e){this.getValue(e,"isIgnored")?this.setValue(e,"isIgnored",!1):this.setValue(e,"isIgnored",!0)},attributes:{pathAlias:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},isContact:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFriend:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFamily:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isRevContact:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isRevFriend:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isRevFamily:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnoredBy:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnored:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isMe:{readOnly:!0,getter:function(e,t){var i=this.appContext.getViewer();return!!i&&this.getValue(t,"nsid")===i.nsid}},nsid:{readOnly:!0,defaultFn:function(e){return e}}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","flickr-contacts-add-updater","flickr-contacts-remove-updater","flickr-contacts-edit-updater","flickr-contacts-block-updater","flickr-contacts-unblock-updater","attribute-helpers"]});YUI.add("banner-helper",(function(e,i){var n=require("hermes-core/flog")(i),r=(e.mix({langBundles:["featured-banner"]},e.Localizable),new e.SubscriptionsHelper);e.BannerHelper=function(i){var o=this,t=[],a=[],s={loginMigration:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return e.Promise.resolve()},canShowBanner:function(){var e=!1,n=i.getViewer().isCognitoUser;return i.getViewer().signedIn&&!n&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-features-view","sohp-slideshow-scroll-view","sohp-slideshow-photolist-view","sohp-slideshow-sohp-e-view","sohp-slideshow-view"].indexOf(i.flapp.get("activeView").name)&&(e=!0),e},viewName:"login-migration-banner-view",viewConfig:{}}},pastDue:function(n){var r;function o(){return-1===["pro-checkout-view","sohp-slideshow-features-view","sohp-slideshow-scroll-view","sohp-slideshow-photolist-view","sohp-slideshow-sohp-e-view","sohp-slideshow-view","account-settings-view"].indexOf(i.flapp.get("activeView").name)}return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){var n=i.getViewer();return n.signedIn&&n.isPro?i.getModel("person-models",n.nsid).then((function(e){var i=e.getValue("subscription");r=i.isPastDue})):(r=!1,e.Promise.resolve())},canShowBanner:function(){var e=!1;return i.getViewer().signedIn&&i.getViewer().isPro&&o()&&r&&(e=!0),e&&o()},viewName:"past-due-banner-view",viewConfig:{}}},migrateSubscription:function(n){var o="priority"in n?n.priority:Number.MAX_VALUE,t="placement"in n?n.placement:"header",a=!1,s=!1;return{priority:o,placement:t,load:function(){var n=i.getViewer();return n.signedIn&&n.isPro?i.getModel("effective-subscriptions-models",n.nsid).then(function(n){if(n&&n.getValue("length")>0){var o=r.getEligibleSubscription(n,!0);o&&(a=o.isBraintreeSubscription||o.isDigitalRiverSubscription&&i.flipper.isFlipped("enable-dr-paypal-migrate-banner"),s=o.nextBillingDate&&o.nextBillingDate.isBefore&&o.nextBillingDate.isBefore(e.moment().add(15,"days")))}}.bind(this)):(a=!1,e.Promise.resolve())},canShowBanner:function(){var n=!1;return i.getViewer().signedIn&&i.getViewer().isPro&&a&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-features-view","sohp-slideshow-scroll-view","sohp-slideshow-photolist-view","sohp-slideshow-sohp-e-view","sohp-slideshow-view"].indexOf(i.flapp.get("activeView").name)&&(!i.getCookie(e.config.flickr.banners.dismiss_braintree_migration_banner_name)||i.getCookie(e.config.flickr.banners.dismiss_braintree_migration_banner_name)&&s)&&(n=!0),n},viewName:"subscription-migrate-banner-view",viewConfig:{}}},cookie:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"footer",load:function(){return e.Promise.resolve()},canShowBanner:function(){return!i.getCookie(e.config.flickr.banners.dismiss_cookie_banner_name)&&!i.requiresCookieConsent},viewName:"cookie-banner-view",viewConfig:{}}},cookieConsent:function(n){var r,o="priority"in n?n.priority:Number.MAX_VALUE,t="placement"in n?n.placement:"footer";return{priority:o,placement:t,load:function(){return i.trustarcConsentManager?new e.Promise(((e,n)=>{r=setTimeout(e,1e4),i.trustarcConsentManager.onReady((()=>{clearTimeout(r),e()}))})):e.Promise.resolve()},canShowBanner:function(){var e=i.flipper.isFlipped("enable-cookie-consent-execution-hermes")&&i.requiresCookieConsent&&"truste"in window&&"PrivacyManagerAPI"in window;if(e){var n=window.truste.cma.callApi("getConsentDecision","flickr.com");n&&(e=0===n.consentDecision)}return e},viewName:"trustarc-consent-banner-view",viewConfig:{}}},uploadLimit:function(n){var r;return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return i.getViewer().signedIn?i.getModel("person-profile-models",i.getViewer().nsid).then((function(e){r=e})):e.Promise.resolve()},canShowBanner:function(){var n=!i.getCookie(e.config.flickr.upload_blocking.dismiss_over_upload_limit_message_cookie_name)&&e.UserLimitsHelper.isOverARRLimit(r,i)&&"products-flickrpro-route"!==i.routeConfig.module,o=!i.getCookie(e.config.flickr.upload_blocking.dismiss_at_upload_limit_message_cookie_name)&&e.UserLimitsHelper.isAtUploadLimit(r,i),t=!i.getCookie(e.config.flickr.upload_blocking.dismiss_near_upload_limit_message_cookie_name)&&e.UserLimitsHelper.isNearUploadLimit(r,i);return i.flipper.isFlipped("enable-upload-limit-messages")&&i.getViewer().signedIn&&"pro-checkout-route"!==i.routeConfig.module&&(n||o||t)},viewName:"upload-limit-banner-view",viewConfig:{}}},tosMarketing:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return e.Promise.resolve()},canShowBanner:function(){return"feed-new-page-view"===i.flapp.get("activeView").name&&!i.getCookie(e.config.flickr.banners.dismiss_tos_marketing_banner_name)},viewName:"tos-marketing-banner-view",viewConfig:{},startTime:new Date("2022-03-17T16:00:00.000Z")}},exploreTakeover:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return e.Promise.resolve()},canShowBanner:function(){return!i.getCookie(e.config.flickr.banners.dismiss_explore_takeover_banner)&&-1===["products-pro-view","pro-checkout-view","sohp-slideshow-features-view","sohp-slideshow-scroll-view","sohp-slideshow-photolist-view","sohp-slideshow-sohp-e-view","sohp-slideshow-view"].indexOf(i.flapp.get("activeView").name)},viewName:"explore-takeover-banner-view",viewConfig:{},startTime:new Date("2022-03-31T04:00:00.000Z"),endTime:new Date("2022-04-01T03:55:00.000Z")}},noNonSafe:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return e.Promise.resolve()},canShowBanner:function(){return"feed-new-page-view"===i.flapp.get("activeView").name&&!i.getCookie(e.config.flickr.banners.dismiss_no_nonsafe_banner_name)&&!i.getViewer().isPro},viewName:"no-nonsafe-banner-view",viewConfig:{},startTime:new Date("2022-04-19T16:00:00.000Z")}},foodExplore:function(n){return{priority:"priority"in n?n.priority:Number.MAX_VALUE,placement:"placement"in n?n.placement:"header",load:function(){return e.Promise.resolve()},canShowBanner:function(){return"explore-page-view"===i.flapp.get("activeView").name&&!i.getCookie(e.config.flickr.banners.dismiss_food_explore_banner_name)},viewName:"food-explore-banner-view",viewConfig:{},startTime:new Date("2022-06-30T04:00:00.000Z"),endTime:new Date("2022-07-01T03:55:00.000Z")}}};function c(){a=t.sort((function(e,i){return e.priority-i.priority}))}function l(e){var i,n,r=a.find((function(i,n){var r=void 0===e||i.placement===e,o=new Date,t=o<i.startTime||o>i.endTime;if(r&&!t&&i.canShowBanner())return!0}));if(r)return i=t.indexOf(r),-1!==(n=i)&&(t.splice(n,1),c()),r}return this.loadBanners=function(i){var r;return t=[],a=[],r=i.map((function(i){return(function(i){var r=new s[i.type]({priority:i.priority,placement:i.placement});return r?r.load().then((function(){!(function(e){t.push(e),c()})(r)})).catch((function(e){n.error("Failed to load and register banner.",{err:e})})):e.Promise.resolve()})(i)})),e.Promise.all(r)},this.getBanners=function(e){var i=[];return e.forEach((function(e){var n=l(e);n&&i.push(n)})),i},this.getQueue=function(){return a},this.typeObjects=s,this.renderBannerView=function(e){return(function(e){return i.getView(e.viewName,e.viewConfig).then((function(e){var n;return i.getView("banner-view",{subview:e}).then((function(e){return(n=e).initialize()})).then((function(){return n}))}))})(e).then((function(i){o.fire("renderBanner",{placement:e.placement,bannerView:i})}))},this},e.augment(e.BannerHelper,e.EventTarget)}),"@VERSION@",{requires:["banner-view","event-custom","effective-subscriptions-models","person-models","subscriptions-helper","moment"],optionalRequires:["hermes-core"]});YUI.add("storage-helper",(function(e){e.StorageHelper={setItem:function(t,i,n){var o=n?"sessionStorage":"localStorage";if(e.config.win)try{e.config.win[o][t]=i}catch(e){}},getItem:function(t,i){var n,o=i?"sessionStorage":"localStorage";if(e.config.win)try{n=e.config.win[o][t]}catch(e){}return n},remove:function(t,i){var n=i?"sessionStorage":"localStorage";if(e.config.win)try{e.config.win[n].removeItem(t)}catch(e){}},hasEntries:function(t,i){var n=i?"sessionStorage":"localStorage",o=!1;if(e.config.win)try{o=void 0!==e.config.win[n][t]}catch(e){}return o},isLocalStorageAvailable:function(){var t="checkLSCompat",i=!1;try{e.config.win.localStorage[t]="checkLSCompatValue",e.config.win.localStorage.removeItem(t),i=!0}catch(e){i=!1}return i}},e.Storage={Instance:{_cache:{},_hasSessionStorage:!0,_clientIdKey:"",getClientIdKey:function(){return this._clientIdKey||(this._clientIdKey=e.config.win.appContext.clientId+"_"),this._clientIdKey},get:function(t){var i,n;try{t=t||"",i=this.getClientIdKey()+t,n=this._hasSessionStorage?e.config.win.sessionStorage.getItem(i):this._cache[i]}catch(e){this._hasSessionStorage=!1}return n},set:function(t,i){var n;try{t&&(n=this.getClientIdKey()+t,this._hasSessionStorage?e.config.win.sessionStorage.setItem(n,i):this._cache[n]=i)}catch(e){this._cache[n]=i,this._hasSessionStorage=!1}},has:function(t){var i,n=!1;try{i=this.getClientIdKey()+t,n=this._hasSessionStorage?!!e.config.win.sessionStorage.getItem(i):!!this._cache[i]}catch(e){this._hasSessionStorage=!1}return n},remove:function(t){var i;try{t=t||"",i=this.getClientIdKey()+t,this._hasSessionStorage?e.config.win.sessionStorage.removeItem(i):this._cache[i]=void 0}catch(e){this._hasSessionStorage=!1}},clear:function(){this.clearByKey(this.getClientIdKey())},clearByKey:function(t){var i,n,o,s=[];try{if(t)if(this._hasSessionStorage){for(i=0,o=e.config.win.sessionStorage.length;i<o;i++)(n=e.config.win.sessionStorage.key(i))&&0===n.indexOf(t)&&s.push(n);for(i=0,o=s.length;i<o;i++)e.config.win.sessionStorage.removeItem(s[i])}else for(e.Object.each(this._cache,(function(e,i){0===i.indexOf(t)&&s.push(i)})),i=0,o=s.length;i<o;i++)this._cache[s[i]]=void 0}catch(e){this._hasSessionStorage=!1}}}}}),"@VERSION@",{requires:[]});YUI.add("cookie-catcher",(function(e,o){"use strict";var n=require("hermes-core/flog")(o);function t(o,n){this.cookieLevelBuckets=n,this.appContext=o,this.expireTime=new Date((new Date).getTime()+864e5*e.config.flickr.cookie_consent.consent_context_expiration_days),this.cookieConsentEnabled=this.appContext.flipper.isFlipped("enable-cookie-consent-execution-hermes")}t.prototype.getCookieLevel=function(e){return-1!==this.cookieLevelBuckets.required.indexOf(e)?0:-1!==this.cookieLevelBuckets.functional.indexOf(e)?1:-1!==this.cookieLevelBuckets.advertising.indexOf(e)?2:null},t.prototype.setCookieIfAllowed=function(o,n,t){if(this.cookieConsentEnabled&&this.appContext.requiresCookieConsent){var i=this.getCookieLevel(o),c=this.appContext.cookieConsentContext?this.appContext.cookieConsentContext.info.cookieBlock.level:0;(null===i||i<=c&&!YUI.Env.isServer)&&e.Cookie.set(o,n,t)}else e.Cookie.set(o,n,t)},t.prototype.getCookieConsentContext=function(){var o=this.appContext.getCookie(e.config.flickr.cookie_consent.consent_context_name),n={};if(n=this.appContext.flipper.isFlipped("enable-geoblock-cookie-consent")?{needsConsent:0,managed:0,changed:0,info:{cookieBlock:{level:0,blockRan:0}}}:{managed:0,changed:0,info:{cookieBlock:{level:0,blockRan:0}}},o)try{n=JSON.parse(o)}catch(o){this.setCookieIfAllowed(e.config.flickr.cookie_consent.consent_context_name,JSON.stringify(n),{path:"/",domain:e.config.flickr.cookies.domain,expires:this.expireTime})}else this.setCookieIfAllowed(e.config.flickr.cookie_consent.consent_context_name,JSON.stringify(n),{path:"/",domain:e.config.flickr.cookies.domain,expires:this.expireTime});return n},t.prototype.updateConsentContext=function(o){var t=this.appContext.cookieConsentContext;t.info.cookieBlock.level!==o&&(t.changed=1,t.info.cookieBlock.level=o,this.setCookieIfAllowed(e.config.flickr.cookie_consent.consent_context_name,JSON.stringify(t),{path:"/",domain:e.config.flickr.cookies.domain,expires:this.expireTime}),e.Snowplough?e.Snowplough.sendStructuredEvent({category:"cookie_consent",action:"consent_update",value:o+".0"}):n.error("Missing Y.Snowplough in CookieCatcher.prototype.updateConsentContext"),console.log("cd refresh"),e.config.win.location.reload())},t.prototype.handleConsentManagerChoice=function(){var e;try{(e=window.truste.cma.callApi("getConsentDecision","flickr.com"))&&e.consentDecision&&Number.isInteger(e.consentDecision)&&this.updateConsentContext(e.consentDecision-1)}catch(e){console.log(e)}},e.namespace("CookieCatcher"),e.CookieCatcher=t}),"@VERSION@",{requires:["cookie","io-base","json-parse","storage-helper","murmurhash","url"],optionalRequires:["hermes-core"]});YUI.add("stacking-overlay-manager",(function(e,i){var n=require("hermes-core/flog")(i);e.StackingOverlayManager=function(i){var s,o,r=[],t={},a={push:function(n,a){var l,d,c=Object.assign({id:e.guid(),view:void 0,overlayClassList:"",hideOverlay:!1,dismissOnOverlayClick:!0,dismissOnEsc:!0,ignorePointerEvents:!1,disableBodyScroll:!0,popBeforePushOther:!1},n),v=e.one("#stacking-overlay-container"),h=this.findFirstPopBeforePushOverlay();return h&&this.pop(h.id),v.setStyles({display:"block"}),r.push(c),(l=e.Node.create('<div class="fluid-modal-overlay"><div class="balls"></div></div>')).addClass("fluid-modal-overlay"),c.overlayClassList&&l.addClass(c.overlayClassList),c.hideOverlay&&l.addClass("transparent"),c.ignorePointerEvents&&l.addClass("invisible"),v.append(l),d=l.on("click",this.handleClick.bind(this)),t[c.id]={overlay:c,node:l,clickHandler:d},c.disableBodyScroll&&e.one("body").setStyles({overflow:"hidden"}),s||(s=e.one("body").on("keyup",this.handleKeyPress.bind(this))),o||(o=i.flapp.on("activeViewChange",this.handleActiveViewChange.bind(this))),c.id},pop:function(i){var n=this;if(i){var t=r.length-1;r.find((function(e,n){return t=n,e.id===i}))&&r.slice(t,r.length).reverse().forEach((function(i,s){i.isPopped||(i.isPopped=!0,n.closeView(i),n.findFirstDisableBodyScrollOverlay()===i&&e.one("body").setStyles({overflow:"visible"}),r.pop(),n.deleteOverlay(i))}))}r.length<=0&&(e.one("#stacking-overlay-container").setStyles({display:"none"}),s&&(s.detach(),s=void 0),o&&(o.detach(),o=void 0))},deleteOverlay:function(e){var i=t[e.id];i&&(i.clickHandler.detach(),i.node.remove(),delete t[e.id])},handleClick:function(e){var i=e.target,n=r.find((function(e){return t[e.id].node===i}));n.dismissOnOverlayClick&&this.pop(n.id)},handleKeyPress:function(e){if(27===e.keyCode){var i=this.findLastDismissOnEscOverlay();i&&this.pop(i.id)}},placeViewAfterOverlay:function(e){var i=t[e];i&&i.overlay.view&&i.node.insert(i.overlay.view.get("container"),"after")},findLastDismissOnEscOverlay:function(){return r.slice().reverse().find((function(e){return e.dismissOnEsc}))},findFirstDisableBodyScrollOverlay:function(){return r.find((function(e){return e.disableBodyScroll}))},findFirstPopBeforePushOverlay:function(){return r.find((function(e){return e.popBeforePushOther}))},closeView:function(e){e&&e.view&&(e.view.close?e.view.close():(n.warn("The overlay associated with the view "+e.view.name+" was popped, but the view has no close function. Consider implementing one."),e.view.destroy({remove:!0})))},handleActiveViewChange:function(e){this.popAll()},popAll:function(){var e=r.length>0?r[0]:void 0;e&&this.pop(e.id)},hasOverlay:function(){return r.length>0}};return e.augment(a,e.EventTarget),a}}),"@VERSION@",{requires:["event-custom"],optionalRequires:["hermes-core"],langBundles:["common"]});YUI.add("trustarc-consent-manager",(function(e,n){var t=require("hermes-core/flog")(n);e.TrustarcConsentManager=function(n){var o,r,i,a=this,c=!1,s=n.cookieConsentContext;function l(t){var o;if(t&&t.data){try{o=JSON.parse(t.data)}catch(e){return}if(o&&(o.PrivacyManagerAPI||o.PrivacyManagerAPI)){var r={},i=e.config.win.PrivacyManagerAPI.callApi("getGDPRConsentDecision",e.config.win.location.host).consentDecision;i&&i.forEach((function(e){r[e]||(r[e]=1)})),i.length&&0!==i[0]&&n.cookieCatcher.handleConsentManagerChoice()}}}function u(){if("truste"in window&&"PrivacyManagerAPI"in window){clearTimeout(r);var n=e.config.win.postMessage&&setInterval((function(){if(e.config.win.PrivacyManagerAPI&&n){var t={PrivacyManagerAPI:{action:"getConsentDecision",timestamp:(new Date).getTime(),self:e.config.win.location.host}};e.config.win.top.postMessage(JSON.stringify(t),"*"),n=clearInterval(n)}}),50);e.config.win.addEventListener("message",l.bind(this)),o=e.one("body").all(".trustarc-cookie-pref-link").on("click",g),c=!0,a.fire("ready")}else r=setTimeout(u.bind(this),250)}function f(){var t=e.one("#consent_blackbar");n.trustArcBannerClone?(clearTimeout(i),e.one("body").appendChild(n.trustArcBannerClone)):t?(clearTimeout(i),n.trustArcBannerClone=t):i=setTimeout(f.bind(this),100)}function g(n){var t=e.one("#consent_blackbar");return n.halt(),t&&t.addClass("active"),e.config.win.truste.eu.reopenBanner(),c=!0,a.fire("reopen"),!1}return this.load=function(){if(c=!1,!n.requiresCookieConsent)return this;if(e.Snowplough&&s.freshServerContext){var o=new Date((new Date).getTime()+864e5*e.config.flickr.cookie_consent.consent_context_expiration_days);e.Snowplough.sendStructuredEvent({category:"cookie_consent",action:"consent_new"}),delete s.freshServerContext,n.cookieCatcher.setCookieIfAllowed(e.config.flickr.cookie_consent.consent_context_name,JSON.stringify(s),{path:"/",domain:e.config.flickr.cookies.domain,expires:o})}else t.error("Missing Y.Snowplough in trustarc-consent-manager.load");return u(),f(),this},this.reset=function(){e.one("#consent_blackbar"),n.trustArcBannerClone&&n.trustArcBannerClone.getDOMNode()&&n.trustArcBannerClone.removeClass("active"),o&&(o.detach(),o=void 0),clearTimeout(r),clearTimeout(i),r=void 0,i=void 0},this.onReady=function(e){if(!c)return a.on("ready",e);e()},this},e.augment(e.TrustarcConsentManager,e.EventTarget)}),"@VERSION@",{requires:["promise"],optionalRequires:["hermes-core"],langBundles:["common"]});YUI.add("datalayer",(function(e,a){var r=require("hermes-core/flog")(a);function t(e){this.appContext=e}t.prototype.initDataLayer=function(){YUI.Env.isServer?r.error("Server cant set data layer"):(window.dataLayer=window.dataLayer||{page:{pageID:"",pageName:"",destinationURL:"",referringURL:"",onsiteSearchTerm:"",author:"",safetyLevel:"",tags:[],camera:{make:"",model:"",name:"",type:""},geo:{country:"",region:"",city:""}},user:{profileInfo:{profileID:"",userName:"",language:"",intl:"",signedIn:!1},address:"",segments:{isNewRegistration:null,isUserNewCustomer:null,customerClassDimension:"",visitorLifetimeValue:0,pro:!1,list:[]}}},r.info("Init dataLayer",window.dataLayer))},t.prototype.updateDataLayer=function(){if(YUI.Env.isServer)r.error("Server cant set data layer");else{window.dataLayer||this.initDataLayer();try{var a=this.appContext.getViewer()||null;a&&(a.signedIn?(window.dataLayer.user.profileInfo.signedIn=!0,window.dataLayer.user.profileInfo.profileID=a.nsid,window.dataLayer.user.profileInfo.intl=a.intl,window.dataLayer.user.segments.pro=!!a.isPro,window.dataLayer.user.segments.list=a.segments||[]):window.dataLayer.user.profileInfo.signedIn=!1),window.navigator&&window.navigator.language&&(window.dataLayer.user.profileInfo.language=window.navigator.language),window.dataLayer.page.photoId=null,window.dataLayer.page.geo={country:"",region:"",city:""},window.dataLayer.page.camera={make:"",model:"",name:"",type:""},window.dataLayer.page.pageID=e.murmurhash(document.title,document.title+" insecure hawaiian volcano salt"),window.dataLayer.page.pageName=this.appContext.flapp.get("activeView").name,window.dataLayer.page.destinationURL=document.location.href,r.info("Updated dataLayer")}catch(e){r.error("Error updating data layer"),r.error(e)}}},t.prototype.setDataLayerProp=function(a,t){!YUI.Env.isServer&&window.dataLayer?(e.Object.setValue(window.dataLayer,a.split("."),t),r.info("Set data layer prop "+a+" = "+t)):r.error("Data layer unavailable.")},e.namespace("DataLayer"),e.DataLayer=t}),"@VERSION@",{requires:["murmurhash"],optionalRequires:["hermes-core"]});YUI.add("app-context",(function(e,i){var t,o=require("hermes-core/flog")(i),n=require("hermes-core/fletrics"),r=e.config.flickr.api.default_timeout,s=e.config.flickr.api.retry_timeout,a=[117,118,119],l=new RegExp(e.config.flickr.api.write_api_method_regex),c=e.config.flickr.model_eviction,h={};(t=e.AppContext=function(i){(i=i||{}).request&&(this.request=i.request),this.params={},this._initializeParams(i),this.viewTiming={},this.modelRegistries={},this.modelImportExport=new e.ModelImportExport(this),this.flickrAPI=new e.FlickrAPI(this.request,this),this.auth=i.auth,this.flapp=i.flapp,this.writeAPICallsMadeOnThisPage={},this._moduleInstances={},this._pendingYUIPromises={},this._loadedViews={},this._apiCalls={},this._previousLocation=null,this._uploadInProgress=!1,this._pendingUploadErrorModal=null,this._concurrentAPICalls=0,this._apiQueueOrder=[],this._apiQueueFunctions={},this._preliminaryNsid=null,this.flipper=new e.Flipper(i.flipper),this.segments=new e.Segments(i.auth&&i.auth.user?i.auth.user.segments:[]),this.experiments={fullscreen:new e.Experiments.Fullscreen(this),optOut:new e.Experiments.OptOut(this)},this.secure="https"===this.protocol,this.adManager=new e.AdManager(this.params.referrer,this),this.adManager.setAdViewStatus(),this.allowThirdPartyContent=!0,this.cookieCatcher=new e.CookieCatcher(this,{required:e.config.flickr.cookie_consent.cookie_level_buckets.required,functional:e.config.flickr.cookie_consent.cookie_level_buckets.functional,advertising:e.config.flickr.cookie_consent.cookie_level_buckets.advertising}),this.requiresCookieConsent=!0,this.flipper.isFlipped("enable-cookie-consent-execution-hermes")&&(YUI.Env.isServer?(this.flipper.isFlipped("enable-geoblock-cookie-consent")&&!this.request.requiresCookieConsent&&(this.requiresCookieConsent=!1),this.cookieConsentContext=this.request.cookie_consent_context):(this.cookieConsentContext=this.cookieCatcher.getCookieConsentContext(),this.flipper.isFlipped("enable-geoblock-cookie-consent")&&!this.cookieConsentContext.needsConsent&&(this.requiresCookieConsent=!1)),this.flipper.isFlipped("enable-geoblock-cookie-consent")?this.requiresCookieConsent&&(this.allowThirdPartyContent=e.config.flickr.cookie_consent.third_party_level_consent<=this.cookieConsentContext.info.cookieBlock.level):this.allowThirdPartyContent=e.config.flickr.cookie_consent.third_party_level_consent<=this.cookieConsentContext.info.cookieBlock.level),this.dataLayer=new e.DataLayer(this),this.viewportData=new e.ViewportData(this),this.clientId="f"+Math.round(1e4*Math.random()).toString(36),this.isCSSLoaded=!1,this.bannerManager=new e.BannerHelper(this),YUI.Env.isServer||(this.overlayManager=new e.StackingOverlayManager(this)),!YUI.Env.isServer&&this.flipper.isFlipped("enable-cookie-consent-execution-hermes")&&this.requiresCookieConsent&&(this.trustarcConsentManager=new e.TrustarcConsentManager(this)),this.initGlobalEvictionExemptionConfig()}).getValidParams=function(){return["bucket","protocol","buckets","slice","random_slice","referrer","flipper","lang","gp_code","gp_owner","share_code"]},t.prototype={routeConfig:{},_initializeParams:function(e){var i=this;t.getValidParams().forEach((function(t){e.request&&t in e.request&&(e[t]=e.request[t]),t in e&&(i[t]=e[t],i.params[t]=e[t])}))},promisedUse:function(i){var t=YUI.Env.isServer,o=t?this.request.app.yui:e;return new e.Promise((function(e,n){o.use(i,(function(i,o){t?e(i):o&&"success"in o?o.success?e(i):n(o.msg):n("Y.use: no status provided")}))}))},instantiateYUIModule:function(i,t){if(!e.Lang.isString(i)||!e.Lang.isFunction(t))return e.Promise.reject("[app-context] `instantiateYUIModule` called without a `name` or `initializer`.");var o=this._moduleInstances,n=this._pendingYUIPromises;return n[i]||(o[i]?n[i]=e.Promise.resolve(o[i]):n[i]=this.promisedUse(i).then((function(){var e=t();return o[i]=e,delete n[i],e}))),n[i]},getModelRegistry:function(i){if(!e.Lang.isString(i))return e.Promise.reject("[app-context] `getModelRegistry` called without a `name`.");var t,r=this;return this.instantiateYUIModule(i,(function(s){if(!e.Models||!e.Models[i]||"function"!=typeof e.Models[i])throw o.error("There was an error loading the modelregistry",{status:s}),n.increment("hermes.appContext.getmodelregistry.failures"),(t=new Error("[app-context] - Model registry failed to load:"+i)).moduleLoadingError=!0,t;var a=new e.Models[i](r);return r.modelRegistries[i]=a,a}))},getModel:function(i,t,o){return e.Lang.isString(i)?t?this.getModelRegistry(i).then(function(i){return this._refetchExistingModels&&(e.Lang.isObject(t,!0)?i.attributeSearch(t):[t]).forEach(function(e){this.canEvictModel(i,e)&&this.evictModel(i,e)}.bind(this)),i.get(t,o)}.bind(this)):e.Promise.reject("[app-context] `getModel` ("+i+") called without `modelIdOrAttributes`."):e.Promise.reject("[app-context] `getModel` called without a `registryName`.")},markAsNewlyFetched:function(e,i){this._refetchExistingModels&&(this._refetchedModels[e]||(this._refetchedModels[e]={}),this._refetchedModels[e][i]=!0)},getRoute:function(i){var t,r=this;return this.instantiateYUIModule(i,(function(s){if(!e.Routes||!e.Routes[i]||"function"!=typeof e.Routes[i])throw o.error("There was an error loading the route",{status:s}),n.increment("hermes.appContext.getroute.failures"),(t=new Error("[app-context] - Route failed to load:"+i)).moduleLoadingError=!0,t;return new e.Routes[i](r)}))},getView:function(i,t,r){var s,a=this;return(t=t||{}).appContext=a,a.promisedUse(i).then((function(r){if(!e.Views||!e.Views[i]||"function"!=typeof e.Views[i])throw o.error("There was an error loading the view",{status:r}),n.increment("hermes.appContext.getview.failures"),(s=new Error("[app-context] - View failed to load:"+i)).moduleLoadingError=!0,s;return a._loadedViews[i]=!0,new e.Views[i](t)}))},getLoadedViews:function(){return Object.keys(this._loadedViews)},setGPCredentials:function(e){var i=this;null===e?(delete i.params.gp_owner,delete i.params.gp_code,delete i.params.share_code,delete h.gp_owner,delete h.gp_code,delete h.share_code):null!==e&&e.gp_code&&(i.params.gp_owner=e.gp_owner,i.params.gp_code=e.gp_code,i.params.share_code=e.share_code,h.gp_owner=e.gp_owner,h.gp_code=e.gp_code,h.share_code=e.share_code)},getCookie:function(i){return YUI.Env.isServer?this.request.cookies[escape(i)]:e.Cookie.get(i)},setCookie:function(i){if(YUI.Env.isServer)o.warn("You can't set a cookie from the server with AppContext -- use middleware.",i);else{i.cookieName&&void 0!==i.cookieValue&&i.path||o.error("Missing important parameters to set a cookie");var t=i.cookieName,n=i.cookieValue,r=i.domain||".flickr.com",s=i.path,a=i.expiresMonthsFromNow||3,l=i.expires?i.expires:e.moment().add(a,"months").toDate();i.remove&&e.Cookie.remove(t,{domain:i.domain||".flickr.com",path:s}),this.cookieCatcher.setCookieIfAllowed(t,n,{domain:r,path:s,expires:l})}},removeCookie:function(i){YUI.Env.isServer?o.warn("You can't remove a cookie from the server with AppContext -- use middleware.",i):(i.cookieName&&i.path||o.error("Missing important parameters to remove a cookie"),e.Cookie.remove(i.cookieName,{domain:i.domain||".flickr.com",path:i.path}))},reissueCookie:function(e,i){var t;e&&i||o.error("Missing important parameters to reissue a cookie"),t=this.getCookie(e),this.setCookie({cookieName:e,path:i,cookieValue:t})},getViewer:function(){var e={},i=this;return e.getPixelRatio=function(){var e;return(e=YUI.Env.isServer?i.getCookie("density"):window.devicePixelRatio)||(e=1),e},this.auth&&this.auth.signedIn?(e.nsid=this.auth.user.nsid,e.intl=this.auth.intl,e.signedIn=this.auth.signedIn,e.isInsecureGod=this.auth.isInsecureGod,e.isMinor=this.auth.isMinor,e.isPro=this.auth.user.ispro,e.isCognitoUser=this.auth.isCognitoUser,e.prefs={timezonePref:this.auth.timezonePref,downloadAccessPref:this.auth.downloadAccessPref},e.segments=this.auth.user.segments||[]):this._preliminaryNsid?(e.nsid=this._preliminaryNsid,e.signedIn=!0):(e.signedIn=!1,e.prefs={timezonePref:{name:"",dst:!1,offset:"+00:00",isDefaults:!0}}),YUI.Env.isServer?e.userAdBlockEnabled=null:e.userAdBlockEnabled=this.adManager.getAdBlockStatus(),e},setPreliminaryViewerNsid:function(e){this._preliminaryNsid=e},getKeyboardManager:function(){return this._keyboardManager||(this._keyboardManager=new e.KeyboardManager),this._keyboardManager},initGlobalEvictionExemptionConfig:function(){var e=this.getViewer().nsid;this._globalEvictionExemptionConfig={},e&&(this._globalEvictionExemptionConfig["person-preferences-models"]={exemptIds:[e]})},getPreviousURL:function(){var e="";return this._previousLocation&&(e=this._previousLocation.pathname,this._previousLocation.querystring&&(e+="?"+this._previousLocation.querystring),this._previousLocation.hash&&(e+="#"+this._previousLocation.hash)),e},getPreviousLocation:function(){return e.merge(this._previousLocation)},setPreviousLocation:function(){this._previousLocation=this.getLocation()},updateModelRefetchState:function(i,t){if(!this.flipper.isFlipped("evict-models-on-navigate")||!i||t)return this._refetchExistingModels=!1,void(this._refetchedModels=null);var o,n;this._previousLocation&&(o=e.URLHelper.getSiteSectionByURL(this._previousLocation.pathname)),i&&(i="/"+i.split("/").slice(3).join("/"),n=e.URLHelper.getSiteSectionByURL(i)),this._refetchExistingModels=void 0,n&&c.entry_refetch_exemptions[n.name]&&(this._refetchExistingModels=!1),o&&c.exit_refetch_exemptions[o.name]&&(this._refetchExistingModels=!1),void 0===this._refetchExistingModels&&n&&o&&(c.transition_refetch_exemptions[o.name]&&c.transition_refetch_exemptions[o.name][n.name]?this._refetchExistingModels=!1:this._refetchExistingModels=o.name!==n.name),void 0===this._refetchExistingModels&&(this._refetchExistingModels=!1),this._refetchedModels={}},hasClientSideRouted:function(){return!!this._clientSideRouted},setClientSideRouted:function(e){this._clientSideRouted=e},getReferrer:function(){var e;try{e=this.flapp.get("activeView").getViewDataFromHistory("referrer")}catch(e){}return e},getLocation:function(){var i;return YUI.Env.isServer?(i={protocol:this.request.protocol,hostname:this.request.hostname,pathname:this.request.path,query:this.request.query,querystring:this.request.query?e.QueryString.stringify(this.request.query):"",hash:""}).href=i.protocol+"://"+i.hostname+this.request.originalUrl:(i={protocol:e.config.win.location.protocol.split(":")[0],hostname:e.config.win.location.hostname,pathname:e.config.win.location.pathname,querystring:e.config.win.location.search.split("?")[1],href:e.config.win.location.href,hash:e.config.win.location.hash}).query=i.querystring?e.QueryString.parse(i.querystring):"",i},getViewCounter:function(){return this._viewCounter||(this._viewCounter=new e.ViewCounter({appContext:this})),this._viewCounter},getBucket:function(e){if(this.buckets)return this.buckets[e]},handleMismatchedNSID:function(){var i,t;i=e.mix({langBundles:["common"],appContext:this},e.Localizable),(t=new e.Views.FluidModal({title:i.intlMessage({intlName:"common.ERROR"}),actionButtonLabel:i.intlMessage({intlName:"common.OK"}),textMessage:i.intlMessage({intlName:"common.MISMATCHED_NSID_ERROR"}),appContext:this,dismissOnOverlayClick:!1,dismissOnActionClick:!0,actionButtonDisabled:!1,showCancelButton:!0,hideModalOverlay:!1,showCancelX:!0})).on("actionClick",(function(i){e.config.win.location.reload(!0)})),t.show()},mitigateClientPanda:function(i){var t,o;return t=e.mix({langBundles:["common"],appContext:this},e.Localizable),(o=new e.Views.FluidModal({title:t.intlMessage({intlName:"common.ERROR"}),actionButtonLabel:t.intlMessage({intlName:"common.OK"}),htmlMessage:t.intlMessage({intlName:i}),appContext:this,dismissOnOverlayClick:!1,dismissOnActionClick:!0,actionButtonDisabled:!1,showCancelButton:!0,hideModalOverlay:!1,showCancelX:!0})).on("actionClick",(function(i){e.config.win.location.reload(!0)})),o.show(),e.PromiseChainDestroyer()},callAPI:function(i,t,n,c){var u,d,p,f=this,g=[i,t=t||{},null,c];return n=n&&!YUI.Env.isServer,g=null!==h?[i,e.merge(t,h),null,c]:[i,t,null,c],u=i+"__"+Object.keys(t).sort().map((function(e){return encodeURIComponent(e)+"_"+encodeURIComponent(t[e])})).join("__"),this._apiCalls[u]?(e.config.flickr.cameraroll.suppress_logging&&"flickr.cameraroll.getPhotosByOffset"===i||o.log("Reusing API call",{method:i}),f._apiQueueOrder.length>1&&(p=f._apiQueueOrder.indexOf(u))>-1&&p<f._apiQueueOrder.length-1&&(f._apiQueueOrder.splice(p,1),f._apiQueueOrder.push(u)),this._apiCalls[u].then((function(i){return e.clone(i,!0)}),(function(i){throw e.clone(i,!0)}))):(n&&(g.push(null),g.push({timeout:r})),i.match(l)&&this.cacheWriteAPICall(u,i),this._apiCalls[u]=new e.Promise((function(t,r){var l;l=function(){f.flickrAPI.callMethod.apply(f.flickrAPI,g).then((function(e){return f.onAPICallComplete(u,!0),e}),(function(t){if(f.onAPICallComplete(u,!1),!YUI.Env.isServer&&-1!==a.indexOf(t.code))return f.handleMismatchedNSID(),e.PromiseChainDestroyer();if(!YUI.Env.isServer&&0===t.status&&0===t.total)return f.mitigateClientPanda("common.NETWORK_CONNECTIVITY_ISSUE");if(n&&(t.clientTimeout||0===t.status||t.transportFailure)){if(o.log("Retrying API call",{method:i}),delete f._apiCalls[u],!YUI.Env.isServer&&e.config.win.beaconError){if(e.config.win.document)try{t.domain=e.config.win.document.domain}catch(e){}e.config.win.beaconError("[app-context] Retrying API ",e.config.win.location.href,t)}return(d=g[g.length-1]).timeout&&(d.timeout=s),f._apiCalls[u]=f.flickrAPI.callMethod.apply(f.flickrAPI,g).then((function(t){return f.onAPICallComplete(u,!0),o.log("Successfully retried API call",{method:i}),e.fire("appContext:apiRetry",{apiMethod:i,code:418}),!YUI.Env.isServer&&e.config.win.beaconError&&e.config.win.beaconError("[app-context] Successful API retry ",e.config.win.location.href,{}),t}),(function(t){throw f.onAPICallComplete(u,!1),o.log("Failed retry of API call",{method:i}),e.fire("appContext:apiRetry",{apiMethod:i,code:408}),!YUI.Env.isServer&&e.config.win.beaconError&&e.config.win.beaconError("[app-context] Failed API retry ",e.config.win.location.href,{}),t})),f._concurrentAPICalls++,f._apiCalls[u]}throw t})).then(t,r)},YUI.Env.isServer?l():(f._apiQueueOrder.push(u),f._apiQueueFunctions[u]=l,f.callNextInQueue())})),this._apiCalls[u])},callNextInQueue:function(){var i,t,o=e.config.flickr.api.max_concurrent_api_calls;this._apiQueueOrder.length&&this._concurrentAPICalls<o&&(this._concurrentAPICalls++,i=this._apiQueueOrder.pop(),t=this._apiQueueFunctions[i],delete this._apiQueueFunctions[i],t())},cacheWriteAPICall:function(e,i){this.writeAPICallsMadeOnThisPage[e]={methodName:i,completed:!1,failed:!1}},onAPICallComplete:function(e,i){var t=this.writeAPICallsMadeOnThisPage[e];t&&(t.completed=!0,t.failed=!i),delete this._apiCalls[e],this._concurrentAPICalls--,this.callNextInQueue()},clearWriteAPICallCache:function(){this.writeAPICallsMadeOnThisPage={}},canEvictModel:function(e,i){var t,o;return!(!e||!i)&&(!!e.exists(i)&&(t=e.name,!((o=this._globalEvictionExemptionConfig[t])&&o.exemptIds&&-1!==o.exemptIds.indexOf(i))&&(this._refetchedModels[t]||(this._refetchedModels[t]={}),!this._refetchedModels[t][i])))},evictModel:function(e,i){var t=e.name;this.flipper.isFlipped("model-eviction-debugging")&&console.log("[EVICT] "+t+" ["+i+"]"),e.getOwnedModels(i).forEach(function(e){this.canEvictModel(e.registry,e.id)&&this.evictModel(e.registry,e.id)}.bind(this)),e.remove(i)},evictModels:function(i){var t,n,r,s,a=this.getViewer().nsid,l=[],c=this.modelRegistries;for(t in this.writeAPICallsMadeOnThisPage)(n=this.writeAPICallsMadeOnThisPage[t]).completed&&!n.failed&&l.push(n);l.forEach((function(e){})),this._refetchExistingModels&&(a&&(i=e.merge(i,this._globalEvictionExemptionConfig)),Object.keys(this.modelRegistries).forEach((function(e){r=c[e],(s=i[e])?s.exemptIds?(s.evictIds&&o.warn("Error in eviction config for registry: cannot specify both an allowlist (`evictIds`) and a denylist (`exemptIds`) for model eviction. Ignoring `evictIds` and evicting all models except those listed in `exemptIds`.",{modelRegistryName:e}),r.removeAllExcept(s.exemptIds)):s.evictIds&&s.evictIds.forEach((function(i){c[e].remove(i)})):c[e].removeAll()})))},markUploadInProgress:function(e){this._uploadInProgress=e},uploadIsInProgress:function(){return this._uploadInProgress},storePendingUploadErrorModal:function(e){this._pendingUploadErrorModal=e},retrievePendingUploadErrorModal:function(e){return this._pendingUploadErrorModal},_doForcedServerRender:function(){if(!YUI.Env.isServer||!this.request||!this.request.headers)return!1;var e=!1;return e=(e=e||this.request.UA.isBot)||this.request.UA.isSharingBot,this.flipper.isFlipped("enable-server-render-for-unsupported-browsers")&&(e=e||this.request.UA.isUnsupportedBrowser),this.flipper.isFlipped("enable-forced-server-render")&&(e=!0),e},getUA:function(){return YUI.Env.isServer?this.request.UA:e.config.flickr.request.UA},logViewTiming:function(){var e,i=this.flapp.get("activeView"),t=0,o=this;e=function(i,n){t++,Object.keys(i.subviews).forEach((function(r){var s=i.subviews[r].get("container").hasClass("requiredToShowOnServer")||i.subviews[r]._params.requiredToShowOnClient,a=n&&s,l="-";l=s?"ðŸ”¹":"-",l=a?"ðŸ”·":l,console.log("| \t\t "+new Array(t).join(" |\t\t ")+" "+l+" "+r+" (initialization: "+o.viewTiming[r].initialize+"ms) (loadState: "+o.viewTiming[r].loadState+"ms)"),e(i.subviews[r],a)})),t--},console.log(this.routeConfig.module+": "+this.routeTiming+"ms"),console.log("ðŸ”· "+i.name+" (initialization: "+this.viewTiming[i.name].initialize+"ms) (loadState: "+this.viewTiming[i.name].loadState+"ms)"),e(i,!0)}}}),"@VERSION@",{requires:["oop","flickr-api","flickr-promise","promise","model-import-export","cookie","view-counter","flipper","segments","localizable","moment","experiments-fullscreen","experiments-opt-out","moola-manager","viewport-data","querystring-parse-simple","querystring-stringify-simple","url-helper","browser-support","api-helper","banner-helper","cookie-catcher","stacking-overlay-manager","trustarc-consent-manager","datalayer"],optionalRequires:["hermes-core"]});YUI.add("querystring-stringify",function(e,t){var n=e.namespace("QueryString"),r=[],i=e.Lang;n.escape=encodeURIComponent,n.stringify=function(e,t,s){var o,u,a,f,l,c,h=t&&t.sep?t.sep:"&",p=t&&t.eq?t.eq:"=",d=t&&t.arrayKey?t.arrayKey:!1;if(i.isNull(e)||i.isUndefined(e)||i.isFunction(e))return s?n.escape(s)+p:"";if(i.isBoolean(e)||Object.prototype.toString.call(e)==="[object Boolean]")e=+e;if(i.isNumber(e)||i.isString(e))return n.escape(s)+p+n.escape(e);if(i.isArray(e)){c=[],s=d?s+"[]":s,f=e.length;for(a=0;a<f;a++)c.push(n.stringify(e[a],t,s));return c.join(h)}for(a=r.length-1;a>=0;--a)if(r[a]===e)throw new Error("QueryString.stringify. Cyclical reference");r.push(e),c=[],o=s?s+"[":"",u=s?"]":"";for(a in e)e.hasOwnProperty(a)&&(l=o+a+u,c.push(n.stringify(e[a],t,l)));return r.pop(),c=c.join(h),!c&&s?s+"=":c}},"3.16.0",{requires:["yui-base"]});
YUI.add("better-cache",(function(e){var c,t=[],n=0,r={};function o(e,c){return e.score<c.score?-1:e.score>c.score?1:0}function u(){var e,n,u;for(t.sort(o),r={},t.length>c&&(u=t.shift()).callback&&u.callback(),e=t.length,n=0;n<e;n++)r[t[n].key]=n}c=e.config.flickr.better_cache_size||100,e.betterCache={reset:function(){t=[],n=0,r={}},_cache:t,getSize:function(){return t.length},unset:function(e){var c=r[e];void 0!==c&&(t.splice(c,1),u())},set:function(e,c,o){var a;!1!==c?((a=!!r[e]&&t[r[e]])?(t[r[e]].value=c,t[r[e]].score=n++,"function"==typeof o&&(a.callback=o)):(a={key:e,value:c,score:n++},"function"==typeof o&&(a.callback=o),t.push(a)),u()):this.unset(e)},get:function(e){return"number"==typeof r[e]?(t[r[e]].score=++n,t[r[e]].value):null}}}),"@VERSION@");