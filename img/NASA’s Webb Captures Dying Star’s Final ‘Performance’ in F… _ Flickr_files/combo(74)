YUI.add("hermes-template-photo-card-engagement",(function(n,e){var t=n.Template.Handlebars.revive({1:function(n,e,t,l,a){return" theme-overlay"},3:function(n,e,t,l,a){var o=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"\t\t"+n.escapeExpression((o(t,"outlet")||e&&o(e,"outlet")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},null!=e?o(e,"like-engagement-item-view"):e,{name:"outlet",hash:{},data:a,loc:{start:{line:5,column:2},end:{line:5,column:38}}}))+"\n"},5:function(n,e,t,l,a){var o,r=null!=e?e:n.nullContext||{},u=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'\t\t<span role="button" class="engagement-item fave '+(null!=(o=u(t,"if").call(r,null!=(o=null!=(o=null!=e?u(e,"photoItem"):e)?u(o,"engagement"):o)?u(o,"isFaved"):o,{name:"if",hash:{},fn:n.program(6,a,0),inverse:n.noop,data:a,loc:{start:{line:7,column:50},end:{line:7,column:99}}}))?o:"")+(null!=(o=u(t,"if").call(r,null!=(o=null!=(o=null!=e?u(e,"photoItem"):e)?u(o,"engagement"):o)?u(o,"canFave"):o,{name:"if",hash:{},fn:n.noop,inverse:n.program(8,a,0),data:a,loc:{start:{line:7,column:99},end:{line:7,column:155}}}))?o:"")+'" tabindex="0">\n\t\t\t<span class="engagement-icon">\n\t\t\t\t<i class="animated-fave-star"></i>\n\t\t\t</span>\n\t\t\t<span class="engagement-count'+(null!=(o=u(t,"if").call(r,null!=(o=null!=(o=null!=e?u(e,"photoItem"):e)?u(o,"engagement"):o)?u(o,"faveCount"):o,{name:"if",hash:{},fn:n.noop,inverse:n.program(10,a,0),data:a,loc:{start:{line:11,column:32},end:{line:11,column:83}}}))?o:"")+'">\n\t\t\t\t'+(null!=(o=u(t,"if").call(r,null!=(o=null!=(o=null!=e?u(e,"photoItem"):e)?u(o,"engagement"):o)?u(o,"faveCount"):o,{name:"if",hash:{},fn:n.program(12,a,0),inverse:n.noop,data:a,loc:{start:{line:12,column:4},end:{line:12,column:96}}}))?o:"")+"\n\t\t\t</span>\n\t\t</span>\n"},6:function(n,e,t,l,a){return" faved"},8:function(n,e,t,l,a){return" can-not-fave"},10:function(n,e,t,l,a){return" empty"},12:function(n,e,t,l,a){var o,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return n.escapeExpression((r(t,"formatNumber")||e&&r(e,"formatNumber")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},null!=(o=null!=(o=null!=e?r(e,"photoItem"):e)?r(o,"engagement"):o)?r(o,"faveCount"):o,{name:"formatNumber",hash:{},data:a,loc:{start:{line:12,column:42},end:{line:12,column:89}}}))},14:function(n,e,t,l,a){var o,r=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return n.escapeExpression((r(t,"formatNumber")||e&&r(e,"formatNumber")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},null!=(o=null!=(o=null!=e?r(e,"photoItem"):e)?r(o,"engagement"):o)?r(o,"commentCount"):o,{name:"formatNumber",hash:{},data:a,loc:{start:{line:22,column:44},end:{line:22,column:94}}}))},16:function(n,e,t,l,a){return'\t\t<span role="button" class="engagement-item curate" tabindex="0">\n\t\t\t<span class="engagement-icon">\n\t\t\t\t<svg class="icon icon-curate"><use xlink:href="#icon-curate"></use></svg>\n\t\t\t</span>\n\t\t</span>\n'},18:function(n,e,t,l,a){var o=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return"\t\t"+n.escapeExpression((o(t,"outlet")||e&&o(e,"outlet")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},null!=e?o(e,"fluid-share-photo-view"):e,{name:"outlet",hash:{},data:a,loc:{start:{line:33,column:2},end:{line:33,column:35}}}))+"\n"},compiler:[8,">= 4.3.0"],main:function(n,e,t,l,a){var o,r=null!=e?e:n.nullContext||{},u=n.hooks.helperMissing,i=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<div class="photo-card-engagement\n\t'+(null!=(o=(i(t,"ifCond")||e&&i(e,"ifCond")||u).call(r,null!=e?i(e,"theme"):e,"===","overlay",{name:"ifCond",hash:{},fn:n.program(1,a,0),inverse:n.noop,data:a,loc:{start:{line:2,column:1},end:{line:2,column:59}}}))?o:"")+'">\n\n'+(null!=(o=(i(t,"isFlipped")||e&&i(e,"isFlipped")||u).call(r,"enable-likes",{name:"isFlipped",hash:{},fn:n.program(3,a,0),inverse:n.program(5,a,0),data:a,loc:{start:{line:4,column:1},end:{line:15,column:15}}}))?o:"")+'\t\n\t<span role="button" class="engagement-item comment" tabindex="0">\n\t\t<span class="engagement-icon">\n\t\t\t<svg class="icon icon-comment_hollow"><use xlink:href="#icon-comment_hollow"></use></svg>\n\t\t</span>\n\t\t<span class="engagement-count'+(null!=(o=i(t,"if").call(r,null!=(o=null!=(o=null!=e?i(e,"photoItem"):e)?i(o,"engagement"):o)?i(o,"commentCount"):o,{name:"if",hash:{},fn:n.noop,inverse:n.program(10,a,0),data:a,loc:{start:{line:21,column:31},end:{line:21,column:85}}}))?o:"")+'">\n\t\t\t'+(null!=(o=i(t,"if").call(r,null!=(o=null!=(o=null!=e?i(e,"photoItem"):e)?i(o,"engagement"):o)?i(o,"commentCount"):o,{name:"if",hash:{},fn:n.program(14,a,0),inverse:n.noop,data:a,loc:{start:{line:22,column:3},end:{line:22,column:101}}}))?o:"")+"\n\t\t</span>\n\t</span>\n"+(null!=(o=i(t,"if").call(r,null!=e?i(e,"displayCurate"):e,{name:"if",hash:{},fn:n.program(16,a,0),inverse:n.noop,data:a,loc:{start:{line:25,column:1},end:{line:31,column:8}}}))?o:"")+(null!=(o=i(t,"if").call(r,null!=e?i(e,"displayShare"):e,{name:"if",hash:{},fn:n.program(18,a,0),inverse:n.noop,data:a,loc:{start:{line:32,column:1},end:{line:34,column:8}}}))?o:"")+"</div>\n"},useData:!0}),l={};n.Array.each([],(function(e){var t=n.Template.get("hermes/"+e);t&&(l[e]=t)})),n.Template.register("hermes/photo-card-engagement",(function(e,a){return(a=a||{}).partials=a.partials?n.merge(l,a.partials):l,t(e,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("photo-card-engagement-view",(function(e,t){var i=require("hermes-core/flog")(t);e.namespace("Views")[this.name]=e.Base.create("photo-card-engagement-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){this.set("isActiveViewAgnostic",!0),this.signedIn=this.appContext.getViewer().signedIn,this.params=t,this.config={displayCurate:!("displayCurate"in t)||t.displayCurate,displayShare:"displayShare"in t&&t.displayShare,photoItem:t.photoItem,theme:t.theme,enableFaveKey:t.enableFaveKey},this.config.displayCurate=this.config.displayCurate&&this.signedIn,t.subviewParams={"like-engagement-item-view":{photoId:t.photoItem.photoId,showCount:!0,size:"small",isPadded:!1,theme:"overlay"===this.config.theme?"light":void 0},"fluid-share-photo-view":{photoId:t.photoItem.photoId,nsid:t.photoItem.owner.nsid,size:"small",theme:"light"}},this.curationHelper=new e.CurationHelper(this.appContext)},subviewConfig:{"like-engagement-item-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,additionalViewClasses:["engagement-item","like"],disabled:function(){return!this.appContext.flipper.isFlipped("enable-likes")}},"fluid-share-photo-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,additionalViewClasses:["engagement-item","share"]}},buildContainer:function(){this.setContainerWithTemplate("photo-card-engagement",this.config)},activate:function(){var e=this.get("container");this.faveNode=e.one(".engagement-item.fave"),this.commentNode=e.one(".engagement-item.comment"),this.curateNode=e.one(".engagement-item.curate"),this.faveNode&&(this.faveCountNode=this.faveNode.one(".engagement-count"),this.registerEventHandler(this.faveNode.on(["click","key"],this.handleFaveClick.bind(this),"down:13")),this.config.enableFaveKey&&(this.keyEventHandler=this.attachKeyEvent("down:70",this.handleFaveKeyPress.bind(this)))),this.commentNode&&(this.commentIcon=this.commentNode.one(".engagement-icon"),this.commentCountNode=this.commentNode.one(".engagement-count"),this.registerEventHandler(this.commentNode.on(["click","key"],this.handleCommentClick.bind(this),"down:13"))),this.curateNode&&this.registerEventHandler(this.curateNode.on(["click","key"],this.handleCurateClick.bind(this),"down:13"))},handleFaveKeyPress:function(e){70===e.keyCode&&this.handleFaveClick(e)},handleFaveClick:function(t){var n,o=this,a=this.faveNode,s=this.faveCountNode;this.faveNode.hasClass("can-not-fave")||(this.signedIn?this.isFaving||(this.isFaving=!0,this.config.photoItem.engagementModel.toggleFave(),n=this.config.photoItem.engagementModel.getValue("faveCount"),a.toggleClass("faved",this.config.photoItem.engagementModel.getValue("isFaved")),s.toggleClass("empty",0===n),s&&n>0?s.set("text",n):s.set("text",""),this.config.photoItem.engagementModel.remoteUpdate().then((function(){o.isFaving=!1}),(function(e){3!==e.code&&(o.config.photoItem.engagementModel.toggleFave(),a.toggleClass("faved",o.config.photoItem.engagementModel.getValue("isFaved")),s&&(s.set("text",n),s.toggleClass("empty",0===n))),i.error("Error faving photo",{err:e}),o.isFaving=!1}))):this.showSignUpAndFaveModal(this.config.photoItem.photoId,e.config.win.location.href))},handleCommentClick:function(){var t=this,i=new e.Views["photo-comments-view"]({appContext:this.appContext,photoId:this.config.photoItem.photoId,isScrollable:!0,addCommentText:this.intlMessage({intlName:"comments.ADD_PHOTO_COMMENT",mediaType:this.config.photoItem.mediaType})}),n=new e.ModalDroparoundHelper(this.appContext,{configs:{common:{subview:i},droparound:{preferTop:!0,width:400,height:400,anchorElement:this.commentIcon,keyboardAnchorElement:this.commentNode},modal:{height:550,flexLayout:!0}}});n.show(),t.registerEventHandler(e.on("addComment:showingSignupModal",(function(){n.close()}))),t.registerEventHandler(n.on("close",(function(){t.commentNode.removeClass("active"),t.fire("menuClosed")}))),this.commentNode.addClass("active"),this.fire("menuOpened")},handleCurateClick:function(){var e=this,t=this.config.photoItem.isOwner;"fluid-droparound-view"===this.curationHelper.showAddToCuration({photoId:this.config.photoItem.photoId,showAlbums:t,showGalleries:!t,anchorNode:this.curateNode}).name&&(this.fire("menuOpened"),this.curationHelper.on("curateDroparoundClosed",(function(){e.fire("menuClosed"),e.curateNode.removeClass("active")})),this.curateNode.addClass("active"))},showSignUpAndFaveModal:function(t,i){var n,o=this.intlMessage({intlName:"fave-view.SIGN_IN_BEFORE_FAVE_TITLE"}),a=this.intlMessage({intlName:"fave-view.JOIN_FLICKR_AND_FAVE"});n=new e.Views.SignUpModal({appContext:this.appContext,signUpHeaderClass:"signup-fave",signUpTitle:o,signUpMessage:a,beaconPrefix:"fave"}),this.registerEventHandler(n.on("signUpClick",(function(n){e.SigninHelper.signUpPendingFave({id:t},{postLoginUrl:i})}))),this.registerEventHandler(n.on("signInClick",(function(n){e.SigninHelper.addPendingFave({id:t},{postLoginUrl:i})}))),n.show()},toggleCommentNode:function(e){this.commentNode&&this.commentNode.toggleClass("hidden",!e)},toggleFaveNode:function(e){this.faveNode&&this.faveNode.toggleClass("hidden",!e)}})}),"@VERSION@",{requires:["flickr-view","photo-comments-view","fluid-share-photo-view","hermes-template-photo-card-engagement","curation-helper","modal-droparound-helper"],optionalRequires:["hermes-core"],langBundles:["common","comments","fave-view"]});YUI.add("hermes-template-photo-well",(function(n,l){var e=n.Template.Handlebars.revive({1:function(n,l,e,a,t){return" no-click"},3:function(n,l,e,a,t){return" is-hidden"},5:function(n,l,e,a,t){return" is-video"},7:function(n,l,e,a,t){var o,i=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return n.escapeExpression("function"==typeof(o=null!=(o=i(e,"prev-url")||(null!=l?i(l,"prev-url"):l))?o:n.hooks.helperMissing)?o.call(null!=l?l:n.nullContext||{},{name:"prev-url",hash:{},data:t,loc:{start:{line:1,column:174},end:{line:1,column:186}}}):o)},9:function(n,l,e,a,t){return"#"},11:function(n,l,e,a,t){var o,i=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return n.escapeExpression("function"==typeof(o=null!=(o=i(e,"prev-title")||(null!=l?i(l,"prev-title"):l))?o:n.hooks.helperMissing)?o.call(null!=l?l:n.nullContext||{},{name:"prev-title",hash:{},data:t,loc:{start:{line:1,column:227},end:{line:1,column:241}}}):o)},13:function(n,l,e,a,t){var o,i=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return n.escapeExpression("function"==typeof(o=null!=(o=i(e,"next-url")||(null!=l?i(l,"next-url"):l))?o:n.hooks.helperMissing)?o.call(null!=l?l:n.nullContext||{},{name:"next-url",hash:{},data:t,loc:{start:{line:6,column:174},end:{line:6,column:186}}}):o)},15:function(n,l,e,a,t){var o,i=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return n.escapeExpression("function"==typeof(o=null!=(o=i(e,"next-title")||(null!=l?i(l,"next-title"):l))?o:n.hooks.helperMissing)?o.call(null!=l?l:n.nullContext||{},{name:"next-title",hash:{},data:t,loc:{start:{line:6,column:227},end:{line:6,column:241}}}):o)},17:function(n,l,e,a,t){var o,i=null!=l?l:n.nullContext||{},r=n.hooks.helperMissing,u=n.escapeExpression,c=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return(null!=(o=c(e,"if").call(i,null!=l?c(l,"opt-out-enabled"):l,{name:"if",hash:{},fn:n.program(18,t,0),inverse:n.noop,data:t,loc:{start:{line:10,column:1},end:{line:14,column:8}}}))?o:"")+"\n\t"+u((c(e,"outlet")||l&&c(l,"outlet")||r).call(i,null!=l?c(l,"photo-sidebar-toggle-view"):l,{name:"outlet",hash:{},data:t,loc:{start:{line:16,column:1},end:{line:16,column:37}}}))+'\n\n\t<div class="engagement-container"></div>\n\n\t'+u((c(e,"outlet")||l&&c(l,"outlet")||r).call(i,null!=l?c(l,"attribution-view"):l,{name:"outlet",hash:{},data:t,loc:{start:{line:20,column:1},end:{line:20,column:28}}}))+"\n\t"+u((c(e,"outlet")||l&&c(l,"outlet")||r).call(i,null!=l?c(l,"people-notes-view"):l,{name:"outlet",hash:{},data:t,loc:{start:{line:21,column:1},end:{line:21,column:29}}}))+"\n\n"+(null!=(o=c(e,"if").call(i,null!=l?c(l,"similaritySearchURL"):l,{name:"if",hash:{},fn:n.program(20,t,0),inverse:n.noop,data:t,loc:{start:{line:23,column:1},end:{line:25,column:8}}}))?o:"")+"\n"},18:function(n,l,e,a,t){return'\t<div class="feedback-widget">\n\t\t<button class="ui-button ui-button-cta ui-button-transparent"><span>Opt-out &amp; Feedback</span></button>\n\t</div>\n'},20:function(n,l,e,a,t){var o,i,r=null!=l?l:n.nullContext||{},u=n.hooks.helperMissing,c=n.escapeExpression,s=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t\t<a href="'+c("function"==typeof(i=null!=(i=s(e,"similaritySearchURL")||(null!=l?s(l,"similaritySearchURL"):l))?i:u)?i.call(r,{name:"similaritySearchURL",hash:{},data:t,loc:{start:{line:24,column:11},end:{line:24,column:34}}}):i)+'" class="similarity-search-link'+(null!=(o=s(e,"if").call(r,null!=l?s(l,"is-hidden"):l,{name:"if",hash:{},fn:n.program(3,t,0),inverse:n.noop,data:t,loc:{start:{line:24,column:65},end:{line:24,column:99}}}))?o:"")+'" data-track="photoPageSimilaritySearchClick" title="'+c((s(e,"intlMessage")||l&&s(l,"intlMessage")||u).call(r,{name:"intlMessage",hash:{intlName:"common.SEARCH_FOR_SIMILAR_PHOTOS"},data:t,loc:{start:{line:24,column:152},end:{line:24,column:211}}}))+'"><svg class="icon icon-search"><use xlink:href="#icon-search"></use></svg></a>\n'},compiler:[8,">= 4.3.0"],main:function(n,l,e,a,t){var o,i=null!=l?l:n.nullContext||{},r=n.hooks.helperMissing,u=n.escapeExpression,c=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<a class="navigate-target navigate-prev'+(null!=(o=c(e,"if").call(i,null!=l?c(l,"prev-is-not-clickable"):l,{name:"if",hash:{},fn:n.program(1,t,0),inverse:n.noop,data:t,loc:{start:{line:1,column:39},end:{line:1,column:84}}}))?o:"")+(null!=(o=c(e,"if").call(i,null!=l?c(l,"is-hidden"):l,{name:"if",hash:{},fn:n.program(3,t,0),inverse:n.noop,data:t,loc:{start:{line:1,column:84},end:{line:1,column:118}}}))?o:"")+(null!=(o=c(e,"if").call(i,null!=l?c(l,"is-video"):l,{name:"if",hash:{},fn:n.program(5,t,0),inverse:n.noop,data:t,loc:{start:{line:1,column:118},end:{line:1,column:150}}}))?o:"")+'" href="'+(null!=(o=c(e,"if").call(i,null!=l?c(l,"prev-url"):l,{name:"if",hash:{},fn:n.program(7,t,0),inverse:n.program(9,t,0),data:t,loc:{start:{line:1,column:158},end:{line:1,column:202}}}))?o:"")+'" title="'+(null!=(o=c(e,"if").call(i,null!=l?c(l,"prev-url"):l,{name:"if",hash:{},fn:n.program(11,t,0),inverse:n.noop,data:t,loc:{start:{line:1,column:211},end:{line:1,column:248}}}))?o:"")+'"  data-track="prevPhotoButtonClick" data-action="ad"><span class="hide-text">&rarr;</span></a>\n<a class="navigate-target-arrow-only navigate-target navigate-prev'+(null!=(o=c(e,"if").call(i,null!=l?c(l,"prev-is-not-clickable"):l,{name:"if",hash:{},fn:n.program(1,t,0),inverse:n.noop,data:t,loc:{start:{line:2,column:66},end:{line:2,column:111}}}))?o:"")+(null!=(o=c(e,"if").call(i,null!=l?c(l,"is-hidden"):l,{name:"if",hash:{},fn:n.program(3,t,0),inverse:n.noop,data:t,loc:{start:{line:2,column:111},end:{line:2,column:145}}}))?o:"")+(null!=(o=c(e,"if").call(i,null!=l?c(l,"is-video"):l,{name:"if",hash:{},fn:n.program(5,t,0),inverse:n.noop,data:t,loc:{start:{line:2,column:145},end:{line:2,column:177}}}))?o:"")+'" href="'+(null!=(o=c(e,"if").call(i,null!=l?c(l,"prev-url"):l,{name:"if",hash:{},fn:n.program(7,t,0),inverse:n.program(9,t,0),data:t,loc:{start:{line:2,column:185},end:{line:2,column:229}}}))?o:"")+'" data-track="prevPhotoButtonClick" data-action="ad"><span class="hide-text">&larr;</span></a>\n\n'+u((c(e,"outlet")||l&&c(l,"outlet")||r).call(i,null!=l?c(l,"photo-well-media-view"):l,{name:"outlet",hash:{},data:t,loc:{start:{line:4,column:0},end:{line:4,column:32}}}))+'\n\n<a class="navigate-target navigate-next'+(null!=(o=c(e,"if").call(i,null!=l?c(l,"next-is-not-clickable"):l,{name:"if",hash:{},fn:n.program(1,t,0),inverse:n.noop,data:t,loc:{start:{line:6,column:39},end:{line:6,column:84}}}))?o:"")+(null!=(o=c(e,"if").call(i,null!=l?c(l,"is-hidden"):l,{name:"if",hash:{},fn:n.program(3,t,0),inverse:n.noop,data:t,loc:{start:{line:6,column:84},end:{line:6,column:118}}}))?o:"")+(null!=(o=c(e,"if").call(i,null!=l?c(l,"is-video"):l,{name:"if",hash:{},fn:n.program(5,t,0),inverse:n.noop,data:t,loc:{start:{line:6,column:118},end:{line:6,column:150}}}))?o:"")+'" href="'+(null!=(o=c(e,"if").call(i,null!=l?c(l,"next-url"):l,{name:"if",hash:{},fn:n.program(13,t,0),inverse:n.program(9,t,0),data:t,loc:{start:{line:6,column:158},end:{line:6,column:202}}}))?o:"")+'" title="'+(null!=(o=c(e,"if").call(i,null!=l?c(l,"next-url"):l,{name:"if",hash:{},fn:n.program(15,t,0),inverse:n.noop,data:t,loc:{start:{line:6,column:211},end:{line:6,column:248}}}))?o:"")+'" data-track="nextPhotoButtonClick" data-action="ad"><span class="hide-text">&rarr;</span></a>\n<a class="navigate-target-arrow-only navigate-target navigate-next'+(null!=(o=c(e,"if").call(i,null!=l?c(l,"next-is-not-clickable"):l,{name:"if",hash:{},fn:n.program(1,t,0),inverse:n.noop,data:t,loc:{start:{line:7,column:66},end:{line:7,column:111}}}))?o:"")+(null!=(o=c(e,"if").call(i,null!=l?c(l,"is-hidden"):l,{name:"if",hash:{},fn:n.program(3,t,0),inverse:n.noop,data:t,loc:{start:{line:7,column:111},end:{line:7,column:145}}}))?o:"")+(null!=(o=c(e,"if").call(i,null!=l?c(l,"is-video"):l,{name:"if",hash:{},fn:n.program(5,t,0),inverse:n.noop,data:t,loc:{start:{line:7,column:145},end:{line:7,column:177}}}))?o:"")+'" href="'+(null!=(o=c(e,"if").call(i,null!=l?c(l,"next-url"):l,{name:"if",hash:{},fn:n.program(13,t,0),inverse:n.program(9,t,0),data:t,loc:{start:{line:7,column:185},end:{line:7,column:229}}}))?o:"")+'" data-track="nextPhotoButtonClick" data-action="ad"><span class="hide-text">&rarr;</span></a>\n\n'+(null!=(o=c(e,"unless").call(i,null!=l?c(l,"is-ad"):l,{name:"unless",hash:{},fn:n.program(17,t,0),inverse:n.noop,data:t,loc:{start:{line:9,column:0},end:{line:27,column:11}}}))?o:"")+"\n"+u((c(e,"outlet")||l&&c(l,"outlet")||r).call(i,null!=l?c(l,"person-menu-view"):l,{name:"outlet",hash:{},data:t,loc:{start:{line:29,column:0},end:{line:29,column:27}}}))+"\n"+u((c(e,"outlet")||l&&c(l,"outlet")||r).call(i,null!=l?c(l,"group-menu-view"):l,{name:"outlet",hash:{},data:t,loc:{start:{line:30,column:0},end:{line:30,column:26}}}))+"\n"},useData:!0}),a={};n.Array.each([],(function(l){var e=n.Template.get("hermes/"+l);e&&(a[l]=e)})),n.Template.register("hermes/photo-well",(function(l,t){return(t=t||{}).partials=t.partials?n.merge(a,t.partials):a,e(l,t)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-reboot-welcome-dialog-content",(function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,o,a){return"\tWhile we continue to develop the beta experience, we want your feedback. In case you need some of the missing functionality, you can easily opt-out and go back to the old experience.\n"},3:function(e,t,n,o,a){return"\tPlease continue providing us with feedback so we can continue to improve Flickr.\n"},compiler:[8,">= 4.3.0"],main:function(e,t,n,o,a){var r,i=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return"Flickr is about the amazing photos you capture and the communities that you build around these photos. The goal of our photo page redesign is to provide you with a fast photo browsing experience and an easy interface to build &amp; maintain relationships.<br>\n<br>\nOver the last 4 weeks, we received a lot of feedback from the Flickr community regarding the photo page design. Based on the feedback, we are experimenting with different variations of the photo page to identify the best experience.<br>\n<br>\n"+(null!=(r=i(n,"if").call(null!=t?t:e.nullContext||{},null!=t?i(t,"opt-out-enabled"):t,{name:"if",hash:{},fn:e.program(1,a,0),inverse:e.program(3,a,0),data:a,loc:{start:{line:5,column:0},end:{line:9,column:7}}}))?r:"")+"<br>"},useData:!0}),o={};e.Array.each([],(function(t){var n=e.Template.get("hermes/"+t);n&&(o[t]=n)})),e.Template.register("hermes/reboot-welcome-dialog-content",(function(t,a){return(a=a||{}).partials=a.partials?e.merge(o,a.partials):o,n(t,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-photo-opt-out",(function(e,t){var n=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,t,n,l,r){var a,o=null!=t?t:e.nullContext||{},u=e.hooks.helperMissing,i="function",p=e.escapeExpression,s=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<form action="//'+p(typeof(a=null!=(a=s(n,"host")||(null!=t?s(t,"host"):t))?a:u)===i?a.call(o,{name:"host",hash:{},data:r,loc:{start:{line:1,column:16},end:{line:1,column:24}}}):a)+'/help/optin" method="post">\n\t<input type="hidden" name="photo_opt" value="0">\n\t<input type="hidden" name="redirect_url" value="'+p(typeof(a=null!=(a=s(n,"redirect-url")||(null!=t?s(t,"redirect-url"):t))?a:u)===i?a.call(o,{name:"redirect-url",hash:{},data:r,loc:{start:{line:3,column:49},end:{line:3,column:65}}}):a)+'">\n\t<input type="submit" class="ui-button" value="Go back to the old experience">\n</form>'},useData:!0}),l={};e.Array.each([],(function(t){var n=e.Template.get("hermes/"+t);n&&(l[t]=n)})),e.Template.register("hermes/photo-opt-out",(function(t,r){return(r=r||{}).partials=r.partials?e.merge(l,r.partials):l,n(t,r)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-photo-well-media",(function(n,l){var t=n.Template.Handlebars.revive({1:function(n,l,t,e,a){var o,i=null!=l?l:n.nullContext||{},s=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t<div class="restricted-interstitial">\n\t\t<div class="restricted-interstitial-message">\n\t\t\t<h2>'+n.escapeExpression((s(t,"intlMessage")||l&&s(l,"intlMessage")||n.hooks.helperMissing).call(i,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ADULT_CONTENT"},data:a,loc:{start:{line:4,column:7},end:{line:4,column:66}}}))+"</h2>\n"+(null!=(o=s(t,"if").call(i,null!=l?s(l,"isSignedIn"):l,{name:"if",hash:{},fn:n.program(2,a,0),inverse:n.program(5,a,0),data:a,loc:{start:{line:5,column:3},end:{line:14,column:10}}}))?o:"")+"\t\t</div>\n\t</div>\n"},2:function(n,l,t,e,a){var o,i=null!=l?l:n.nullContext||{},s=n.hooks.helperMissing,c=n.escapeExpression,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return"\t\t\t\t<p>"+c((r(t,"intlMessage")||l&&r(l,"intlMessage")||s).call(i,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.MATURE_AUDIENCES"},data:a,loc:{start:{line:6,column:7},end:{line:6,column:69}}}))+"<br />"+c((r(t,"intlMessage")||l&&r(l,"intlMessage")||s).call(i,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.USER_DISCRETION"},data:a,loc:{start:{line:6,column:75},end:{line:6,column:136}}}))+"</p>\n\n"+(null!=(o=r(t,"unless").call(i,null!=l?r(l,"isMinor"):l,{name:"unless",hash:{},fn:n.program(3,a,0),inverse:n.noop,data:a,loc:{start:{line:8,column:4},end:{line:11,column:15}}}))?o:"")},3:function(n,l,t,e,a){var o=null!=l?l:n.nullContext||{},i=n.hooks.helperMissing,s=n.escapeExpression,c=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return"\t\t\t\t\t<p><button class='ui-button'><span>"+s((c(t,"intlMessage")||l&&c(l,"intlMessage")||i).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SHOW_ME_THIS_CONTENT_TYPE"},data:a,loc:{start:{line:9,column:40},end:{line:9,column:111}}}))+"</span></button></p>\n\t\t\t\t\t<p>"+s((c(t,"intlHTMLMessage")||l&&c(l,"intlHTMLMessage")||i).call(o,{name:"intlHTMLMessage",hash:{intlName:"photo-page-scrappy.CHANGE_SAFE_SEARCH_IN_SETTINGS"},data:a,loc:{start:{line:10,column:8},end:{line:10,column:88}}}))+"</p>\n"},5:function(n,l,t,e,a){var o,i=null!=l?l:n.nullContext||{},s=n.hooks.helperMissing,c=n.escapeExpression,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return"\t\t\t\t<p>"+c((r(t,"intlMessage")||l&&r(l,"intlMessage")||s).call(i,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.SIGNED_IN_FOR_CONTENT"},data:a,loc:{start:{line:13,column:7},end:{line:13,column:74}}}))+' <a href="//'+c("function"==typeof(o=null!=(o=r(t,"host")||(null!=l?r(l,"host"):l))?o:s)?o.call(i,{name:"host",hash:{},data:a,loc:{start:{line:13,column:86},end:{line:13,column:94}}}):o)+'/signin/" data-track="photoWellSignInClick">'+c((r(t,"intlMessage")||l&&r(l,"intlMessage")||s).call(i,{name:"intlMessage",hash:{intlName:"common.SIGN_IN"},data:a,loc:{start:{line:13,column:138},end:{line:13,column:179}}}))+"</a></p>\n"},7:function(n,l,t,e,a){var o,i=null!=l?l:n.nullContext||{},s=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return"\n"+(null!=(o=s(t,"if").call(i,null!=l?s(l,"isVideo"):l,{name:"if",hash:{},fn:n.program(8,a,0),inverse:n.program(10,a,0),data:a,loc:{start:{line:19,column:2},end:{line:36,column:9}}}))?o:"")+(null!=(o=s(t,"if").call(i,null!=l?s(l,"isAd"):l,{name:"if",hash:{},fn:n.program(13,a,0),inverse:n.noop,data:a,loc:{start:{line:37,column:1},end:{line:40,column:8}}}))?o:"")},8:function(n,l,t,e,a){var o,i=null!=l?l:n.nullContext||{},s=n.hooks.helperMissing,c="function",r=n.escapeExpression,u=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t\t\t<div class="videoplayer main-photo" style="width:'+r(typeof(o=null!=(o=u(t,"width")||(null!=l?u(l,"width"):l))?o:s)===c?o.call(i,{name:"width",hash:{},data:a,loc:{start:{line:20,column:52},end:{line:20,column:61}}}):o)+"px; height:"+r(typeof(o=null!=(o=u(t,"height")||(null!=l?u(l,"height"):l))?o:s)===c?o.call(i,{name:"height",hash:{},data:a,loc:{start:{line:20,column:72},end:{line:20,column:82}}}):o)+'px;"><video id="video_1" poster="'+r(typeof(o=null!=(o=u(t,"src")||(null!=l?u(l,"src"):l))?o:s)===c?o.call(i,{name:"src",hash:{},data:a,loc:{start:{line:20,column:115},end:{line:20,column:122}}}):o)+'" class="video-js vjs-big-play-centered inherit-size"></video></div>\n'},10:function(n,l,t,e,a){var o,i,s=null!=l?l:n.nullContext||{},c=n.hooks.helperMissing,r=n.escapeExpression,u="function",h=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\n\t\t\t<div class="facade-of-protection-neue '+(null!=(o=h(t,"if").call(s,null!=l?h(l,"is-video"):l,{name:"if",hash:{},fn:n.program(11,a,0),inverse:n.noop,data:a,loc:{start:{line:23,column:41},end:{line:23,column:72}}}))?o:"")+'">\n\t\t\t\t'+r((h(t,"outlet")||l&&h(l,"outlet")||c).call(s,null!=l?h(l,"zoom-view"):l,{name:"outlet",hash:{},data:a,loc:{start:{line:24,column:4},end:{line:24,column:24}}}))+'\n\t\t\t</div>\n\n\t\t\t<img width="'+r(typeof(i=null!=(i=h(t,"width")||(null!=l?h(l,"width"):l))?i:c)===u?i.call(s,{name:"width",hash:{},data:a,loc:{start:{line:27,column:15},end:{line:27,column:24}}}):i)+'" height="'+r(typeof(i=null!=(i=h(t,"height")||(null!=l?h(l,"height"):l))?i:c)===u?i.call(s,{name:"height",hash:{},data:a,loc:{start:{line:27,column:34},end:{line:27,column:44}}}):i)+'" src="'+r(typeof(i=null!=(i=h(t,"src")||(null!=l?h(l,"src"):l))?i:c)===u?i.call(s,{name:"src",hash:{},data:a,loc:{start:{line:27,column:51},end:{line:27,column:58}}}):i)+'" class="low-res-photo" alt="'+r(typeof(i=null!=(i=h(t,"imgAltText")||(null!=l?h(l,"imgAltText"):l))?i:c)===u?i.call(s,{name:"imgAltText",hash:{},data:a,loc:{start:{line:27,column:87},end:{line:27,column:101}}}):i)+'">\n\t\t\t<img width="'+r(typeof(i=null!=(i=h(t,"width")||(null!=l?h(l,"width"):l))?i:c)===u?i.call(s,{name:"width",hash:{},data:a,loc:{start:{line:28,column:15},end:{line:28,column:24}}}):i)+'" height="'+r(typeof(i=null!=(i=h(t,"height")||(null!=l?h(l,"height"):l))?i:c)===u?i.call(s,{name:"height",hash:{},data:a,loc:{start:{line:28,column:34},end:{line:28,column:44}}}):i)+'" src="'+r(typeof(i=null!=(i=h(t,"highResSrc")||(null!=l?h(l,"highResSrc"):l))?i:c)===u?i.call(s,{name:"highResSrc",hash:{},data:a,loc:{start:{line:28,column:51},end:{line:28,column:65}}}):i)+'" class="main-photo is-hidden" alt="'+r(typeof(i=null!=(i=h(t,"imgAltText")||(null!=l?h(l,"imgAltText"):l))?i:c)===u?i.call(s,{name:"imgAltText",hash:{},data:a,loc:{start:{line:28,column:101},end:{line:28,column:115}}}):i)+'">\n\t\t\t<script nonce="'+r(typeof(i=null!=(i=h(t,"cspNonce")||(null!=l?h(l,"cspNonce"):l))?i:c)===u?i.call(s,{name:"cspNonce",hash:{},data:a,loc:{start:{line:29,column:18},end:{line:29,column:30}}}):i)+"\">\n\t\t\tvar img = document.querySelector('.photo-well-media-view img.main-photo');\n\t\t\timg.onload = function () { registerFirstPhoto(img); };\n\t\t\t<\/script>\n\t\t\t<noscript>\n\t\t\t\t<img width=\""+r(typeof(i=null!=(i=h(t,"width")||(null!=l?h(l,"width"):l))?i:c)===u?i.call(s,{name:"width",hash:{},data:a,loc:{start:{line:34,column:16},end:{line:34,column:25}}}):i)+'" height="'+r(typeof(i=null!=(i=h(t,"height")||(null!=l?h(l,"height"):l))?i:c)===u?i.call(s,{name:"height",hash:{},data:a,loc:{start:{line:34,column:35},end:{line:34,column:45}}}):i)+'" src="'+r(typeof(i=null!=(i=h(t,"highResSrc")||(null!=l?h(l,"highResSrc"):l))?i:c)===u?i.call(s,{name:"highResSrc",hash:{},data:a,loc:{start:{line:34,column:52},end:{line:34,column:66}}}):i)+'" class="main-photo" alt="'+r(typeof(i=null!=(i=h(t,"imgAltText")||(null!=l?h(l,"imgAltText"):l))?i:c)===u?i.call(s,{name:"imgAltText",hash:{},data:a,loc:{start:{line:34,column:92},end:{line:34,column:106}}}):i)+'">\n\t\t\t</noscript>\n'},11:function(n,l,t,e,a){return"is-video"},13:function(n,l,t,e,a){var o,i=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t\t\t<span class="ad-info">'+n.escapeExpression((i(t,"intlHTMLMessage")||l&&i(l,"intlHTMLMessage")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},{name:"intlHTMLMessage",hash:{brand:null!=(o=null!=l?i(l,"ad"):l)?i(o,"brand"):o,intlName:"photo-page-scrappy.FIND_OUT_MORE_AD"},data:a,loc:{start:{line:38,column:25},end:{line:38,column:106}}}))+"</span>\n\t\t</a>\n"},compiler:[8,">= 4.3.0"],main:function(n,l,t,e,a){var o,i=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(o=i(t,"if").call(null!=l?l:n.nullContext||{},null!=l?i(l,"needsInterstitial"):l,{name:"if",hash:{},fn:n.program(1,a,0),inverse:n.program(7,a,0),data:a,loc:{start:{line:1,column:0},end:{line:41,column:7}}}))?o:""},useData:!0}),e={};n.Array.each([],(function(l){var t=n.Template.get("hermes/"+l);t&&(e[l]=t)})),n.Template.register("hermes/photo-well-media",(function(l,a){return(a=a||{}).partials=a.partials?n.merge(e,a.partials):e,t(l,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("photo-well-media-view",(function(e,t){var i,o=require("hermes-core/flog")(t);i={photo:{render:function(){var t,i,o=this,n=this.get("photo"),s=new Date,a="";return o.preloadImage&&(o.preloadImage.onload=null),t=this.getPhotoForDisplay(),i=this.getPhotoForDisplay({includeSizes:["sq","q","t","s","n"]}),n.getValue("owner")&&(a=""===n.getValue("title").trim()?this.intlMessage({intlName:"common.UNTITLED"}):n.getValue("title"),a+=" | "+this.intlMessage({intlName:"common.BY_USER",user:n.getValue("owner").getValue("username")})),this.setContainerWithTemplate("photo-well-media",{width:t.width,height:t.height,src:i.url,highResSrc:t.url,imgAltText:a,needsInterstitial:n.getValue("needsInterstitial"),isSignedIn:this.appContext.getViewer().signedIn,isVideo:n.getValue("isVideo"),isMinor:this.appContext.getViewer().isMinor,isAd:this.isAd}),this.fire("subviewViewEvent",t),YUI.Env.isServer?(this.serverWidth=t.width,this.serverHeight=t.height):n.getValue("needsInterstitial")||(o.preloadImage=new Image,o.preloadImage.onload=function(){if(!this.onloadFired&&o.isActiveAndInDOM()){this.onloadFired=!0;var i,n="photoPageShowedSize",a="Ã¸";try{(i=/(?:_([a-z]))?\.jpg/.exec(t.url))&&i[1]&&(a=i[1])}catch(e){}finally{n+=String(a).toUpperCase()}e.rapidTracker.beacon(this.name,n);var r,h=o.get("container").one(".low-res-photo"),l=o.get("container").one(".main-photo");new Date-s<100?(l.removeClass("is-hidden").show(),h.hide()):(l.setStyles({position:"absolute",left:0,top:0,opacity:0}),l.removeClass("is-hidden"),r=function(){l.removeAttribute("style"),h.hide()},e.UA.ie?r():e.use("transition",(function(e){l.transition({duration:.25,opacity:1},r)})))}},o.preloadImage.src=t.url,o.preloadImage.complete&&o.preloadImage.onload()),this}},video:{render:function(){var e=this.get("photo"),t=this.getPhotoForDisplay({excludeSizes:[]}),i=t.url;return this.appContext.flipper.isFlipped("disable-video-playback")&&(i="/images/en-us/video-unavailable/m.png"),!this.player||e.getValue("isVideoPending")||e.getValue("isVideoFailed")?(this.setContainerWithTemplate("photo-well-media",{width:t.width,height:t.height,src:i,needsInterstitial:e.getValue("needsInterstitial"),isVideo:e.getValue("isVideo"),isSignedIn:this.appContext.getViewer().signedIn,"zoom-view":""}),this.fire("subviewViewEvent",t),this):(e.getValue("isVideoPending")||e.getValue("isVideoFailed")||(this.player.dimension?(this.player.dimension("width",t.width),this.player.dimension("height",t.height)):this.player.resize(t.width,t.height)),this)}},ad:{render:function(){return this}}},e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,subviewConfig:{"zoom-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disableIfSmall:!0}},initializer:function(e){return this.photoId=e.photoId,this.isAd=!!e.ad,this.ad=e.ad,""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this},loadState:function(){var t=this;return this.appContext.getModel("photo-models",t.photoId).then((function(i){if(t.set("photo",i),i.getValue("isVideo"))return new e.Promise((function(t,i){e.use("flickr-video-player",(function(){t()}))}))}))},buildContainer:function(){return YUI.Env.isServer||this.set("clientRendered",!0),this.isAd?i.ad.render.call(this):i[this.get("photo").getValue("isVideo")?"video":"photo"].render.call(this),this},handleInterstitialDismissButtonClick:function(t){var i=this,n=this.get("personPreferences"),s=this.get("photo"),a=s.getValue("safetyLevel");e.rapidTracker.beacon(this.name,"restrictedContentInterstitialClick"),n.setValue("safeSearch",a),n.registry.remoteUpdate(i.appContext.auth.user.nsid).then((function(e){s.registry.attributeSearch({needsInterstitial:!0}).forEach((function(e){s.registry.getValue(e,"safetyLevel")<=n.getValue("safeSearch")&&s.registry.setValue(e,"needsInterstitial",!1)})),i.buildContainer()}),(function(e){o.error({err:e}),i.onError(i.intlMessage({intlName:"photo-page-scrappy.COULDNT_UPDATE_SETTINGS"}))}))},activate:function(){var t,i=this,o=i.get("photo"),n=this.getPhotoForDisplay(),s=this.get("container").one(".main-photo");return!o.getValue("isVideo")||o.getValue("isVideoPending")||o.getValue("isVideoFailed")||(i.player=new e.FlickrVideoPlayer({container:i.get("container").one(".videoplayer"),model:o,appContext:i.appContext,videoNode:e.one("#video_1")?e.one("#video_1")._node:null,autoplay:!0,loop:!0,controlBar:{fullscreenToggle:!1}}),i.player.init().then((function(){})),i.on("destroy",(function(){i.player&&(i.player.destroy(),i.player=null)}))),o.getValue("needsInterstitial")||(e.use("global-events",(function(e){i.registerEventHandler(e.globalEvents.subscribe("window:resize",(function(e){i.set("canvasSizeIsDirty",!0),i.buildContainer()})))})),this.registerEventHandler(e.on("flickr:photo-media-well-update",(function(e){i.set("canvasSizeIsDirty",!0),i.buildContainer()}))),!this.isAd&&(!i.get("clientRendered")||s&&n.width!==Number(s.getAttribute("width"))||s&&n.height!==Number(s.getAttribute("height")))&&i.buildContainer()),this.registerEventHandler(e.on("flickr:display-note-box",(function(o){t=e.Node.create('<div class="note-box"></div>'),i.get("container").one(".main-photo").getXY(),i.get("container").append(t),t.setStyles({top:o.noteBoxTop+i.get("container").one(".main-photo").getDOMNode().offsetTop,left:o.noteBoxLeft,width:o.noteBoxWidth,height:o.noteBoxHeight})}))),this.appContext.getViewer().signedIn&&this.appContext.getModel("person-preferences-models",i.appContext.auth.user.nsid).then((function(e){i.set("personPreferences",e),o.getValue("needsInterstitial")&&!this.appContext.getViewer().isMinor&&i.registerEventHandler(i.get("container").one(".restricted-interstitial-message button").on("click",i.handleInterstitialDismissButtonClick,i))})),this},onError:function(t){new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,showBodyLines:!0,showCancelButton:!1,showCancelX:!0,title:this.intlMessage({intlName:"common.ERROR"}),actionButtonLabel:this.intlMessage({intlName:"common.OK"}),message:t,classList:"scrappy-dialog"}).show()},getPhotoForDisplay:function(e){var t,i,o=this.getCanvasSize(),n=this.getPixelRatio(),s=this.get("photo").getSizeToFit(o,e);return t=Math.min(o.height/n,s.height),i=Math.min(o.width/n,s.width/s.height*t),t=Math.min(t,s.height/s.width*i),{width:Math.round(i),height:Math.round(t),url:s.url,pixelRatio:s.width/i}},getCanvasSize:function(){var e,t,i=this.getPixelRatio();return this.get("canvasSizeIsDirty")?YUI.Env.isServer||(t=this.get("container").ancestor())&&(e=t.get("region")).width>0&&e.height>0&&(this.set("canvasSizeIsDirty",!1),this.set("cachedCanvasSize",e),this.appContext.setCookie({remove:!0,cookieName:"photoPW",path:"/photos/",cookieValue:e.width}),this.appContext.setCookie({remove:!0,cookieName:"photoPH",path:"/photos/",cookieValue:e.height}),this.appContext.setCookie({remove:!0,cookieName:"density",path:"/photos/",cookieValue:i})):e=this.get("cachedCanvasSize"),e||(e={top:0,left:0,bottom:500,right:500,width:parseInt(this.appContext.getCookie("photoPW"),10)||500,height:parseInt(this.appContext.getCookie("photoPH"),10)||500}),e.height*=i,e.width*=i,e},getPixelRatio:function(){return this.appContext.getViewer().getPixelRatio()}},{ATTRS:{canvasSizeIsDirty:{value:!0,setter:function(e){return!!e}},cachedCanvasSize:{getter:function(t){return e.merge(t)},setter:function(t){return e.merge(t)}}}})}),"@VERSION@",{requires:["flickr-view","hermes-template-photo-well-media","moment","zoom-view"],optionalRequires:["hermes-core"],optional:["photo-models"],langBundles:["common","photo-page-scrappy"]});